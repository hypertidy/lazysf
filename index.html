<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delayed Read for GDAL Vector Data Sources • lazysf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Delayed Read for GDAL Vector Data Sources">
<meta property="og:description" content="A dplyr back end for data sources supported by GDAL vector drivers, 
    that allows you to work with local or remote sources as if they are in-memory data 
    frames. Basic features works with any GDAL vector data source supported by the
    sf package. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lazysf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mdsumner/lazysf/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="lazysf" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lazysf" class="anchor"></a>lazysf</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of lazysf is to provide interactive delayed read of GDAL vector data sources.</p>
<p>Vector data sources (a.k.a. “shapefiles”) are files or web services or databases that provide tables of data fields. These fields may include spatial geometry data (i.e. points, lines, polygons, and other planar types composed of coordinate paths).</p>
<p>lazysf uses the dplyr/dbplyr ‘tbl_lazy’ mechanism by providing a GDAL-backend like many database packages in R. The convenience function <code><a href="reference/lazysf.html">lazysf()</a></code> provides a single-argument wrapper around the database-like workflows.</p>
<p>See it in action!</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mdsumner/lazysf">lazysf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/Nowosad/spData/raw/master/inst/shapes/NY8_bna_utm18.gpkg"</span>
<span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # Source:   table&lt;sf_bna2_utm18&gt; [?? x 13]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;    AREAKEY AREANAME     X     Y  POP8 TRACTCAS PROPCAS PCTOWNHOME PCTAGE65P</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 360070… Bingham…  4.07 -67.4  3540     3.08 8.70e-4      0.328     0.147</span>
<span class="co">#&gt;  2 360070… Bingham…  4.64 -66.9  3560     4.08 1.15e-3      0.427     0.235</span>
<span class="co">#&gt;  3 360070… Bingham…  5.71 -67.0  3739     1.09 2.92e-4      0.338     0.138</span>
<span class="co">#&gt;  4 360070… Bingham…  7.61 -66.0  2784     1.07 3.84e-4      0.462     0.119</span>
<span class="co">#&gt;  5 360070… Bingham…  7.32 -67.3  2571     3.06 1.19e-3      0.192     0.142</span>
<span class="co">#&gt;  6 360070… Bingham…  8.56 -66.9  2729     1.06 3.88e-4      0.365     0.141</span>
<span class="co">#&gt;  7 360070… Bingham…  9.21 -67.2  3952     2.09 5.29e-4      0.666     0.231</span>
<span class="co">#&gt;  8 360070… Bingham… 10.2  -66.9   993     0.02 2.00e-5      0.667     0.279</span>
<span class="co">#&gt;  9 360070… Bingham…  8.70 -68.3  1908     2.04 1.07e-3      0.459     0.172</span>
<span class="co">#&gt; 10 360070… Bingham…  7.40 -68.1   948     0.02 2.10e-5      0.166     0.179</span>
<span class="co">#&gt; # … with more rows, and 4 more variables: Z &lt;dbl&gt;, AVGIDIST &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PEXPOSURE &lt;dbl&gt;, geom &lt;MULTIPOLYGON [m]&gt;</span>
<span class="va">x</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">AREANAME</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">AREANAME</span><span class="op">)</span> 
<span class="co">#&gt; # Source:     lazy query [?? x 1]</span>
<span class="co">#&gt; # Database:   SFSQLConnection</span>
<span class="co">#&gt; # Ordered by: AREANAME</span>
<span class="co">#&gt;    AREANAME             </span>
<span class="co">#&gt;    &lt;chr&gt;                </span>
<span class="co">#&gt;  1 &lt;NA&gt;                 </span>
<span class="co">#&gt;  2 Auburn city          </span>
<span class="co">#&gt;  3 Baldwinsville village</span>
<span class="co">#&gt;  4 Barker town          </span>
<span class="co">#&gt;  5 Bayberry-Lynelle Mead</span>
<span class="co">#&gt;  6 Binghamton city      </span>
<span class="co">#&gt;  7 Binghamton town      </span>
<span class="co">#&gt;  8 Brookfield town      </span>
<span class="co">#&gt;  9 Camillus village     </span>
<span class="co">#&gt; 10 Canastota village    </span>
<span class="co">#&gt; # … with more rows</span>

<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">x</span> <span class="op">%&gt;%</span> 
                <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">AREANAME</span> <span class="op">%LIKE%</span> <span class="st">"Ca%"</span> <span class="op">|</span> <span class="va">AREANAME</span> <span class="op">%LIKE%</span> <span class="st">"Bi%"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">AREANAME</span>, <span class="va">geom</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="reference/figures/README-sf-action-1.png" width="100%"></p>
<div id="limitations" class="section level2">
<h2 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h2>
<p>These are big promises! It’s very largely format dependent.</p>
<p>We make no claims about performance or convenience, it will be affected by your system and your sf installation - lazysf just takes you closer the GDAL capabilities.</p>
<p>For example, a query on a CSV, GeoJSON, or KML file local or remote is entirely subject to the performance of the matching <a href="https://gdal.org/drivers/vector/index.html">GDAL driver</a>.</p>
<ul>
<li>big text files will be slow, they aren’t a format suitable for database-like access</li>
<li>geometry is not automatic (it <em>is</em> automatic for non-DB formats, with DB-formats it depends on your SQL)</li>
<li>non-DB formats without a geometry column name will be called <code>_ogr_geometry_</code>, other non-DB formats like ESRI’s geodatabase have other names like <code>SHAPE</code>
</li>
<li>non-DB formats have access to special variable names and functions, listed on the <a href="https://gdal.org/user/ogr_sql_dialect.html">OGRSQL page</a>. Real DBs don’t have these special OGRSQL features, but they do have their own.</li>
</ul>
<p>When using dplyr verbs (<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code>, …) we are also subject to the rules of SQL translation. There are no specific ones provided by lazysf but that might change.</p>
<p>Wrappers around lazysf could provide more specific tools for particular formats.</p>
<div id="cant-we-just-do-this-with-sfs-query-argument" class="section level3">
<h3 class="hasAnchor">
<a href="#cant-we-just-do-this-with-sfs-query-argument" class="anchor"></a>Can’t we just do this with sf’s query argument?</h3>
<p>Yes (actually that is what lazysf uses) but with sf alone you get a fully materialized sf data frame, so you better get that query right first time!</p>
<p>With lazysf you get some control over intermediate steps, potentially expensive queries will only be run for a preview of the data until you are ready to fetch it.</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the dev version of lazysf from <a href="https://github.com/mdsumner/lazysf">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"mdsumner/lazysf"</span><span class="op">)</span></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mdsumner/lazysf">lazysf</a></span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package <span class="op">=</span> <span class="st">"sf"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## specify only the data source</span>
<span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>
<span class="co">#&gt; # Source:   table&lt;nc.gpkg&gt; [?? x 15]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;     AREA PERIMETER CNTY_ CNTY_ID NAME  FIPS  FIPSNO CRESS_ID BIR74 SID74 NWBIR74</span>
<span class="co">#&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 0.114      1.44  1825    1825 Ashe  37009  37009        5  1091     1      10</span>
<span class="co">#&gt;  2 0.061      1.23  1827    1827 Alle… 37005  37005        3   487     0      10</span>
<span class="co">#&gt;  3 0.143      1.63  1828    1828 Surry 37171  37171       86  3188     5     208</span>
<span class="co">#&gt;  4 0.07       2.97  1831    1831 Curr… 37053  37053       27   508     1     123</span>
<span class="co">#&gt;  5 0.153      2.21  1832    1832 Nort… 37131  37131       66  1421     9    1066</span>
<span class="co">#&gt;  6 0.097      1.67  1833    1833 Hert… 37091  37091       46  1452     7     954</span>
<span class="co">#&gt;  7 0.062      1.55  1834    1834 Camd… 37029  37029       15   286     0     115</span>
<span class="co">#&gt;  8 0.091      1.28  1835    1835 Gates 37073  37073       37   420     0     254</span>
<span class="co">#&gt;  9 0.118      1.42  1836    1836 Warr… 37185  37185       93   968     4     748</span>
<span class="co">#&gt; 10 0.124      1.43  1837    1837 Stok… 37169  37169       85  1612     1     160</span>
<span class="co">#&gt; # … with more rows, and 4 more variables: BIR79 &lt;dbl&gt;, SID79 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   NWBIR79 &lt;dbl&gt;, geom &lt;MULTIPOLYGON [°]&gt;</span>

<span class="co">## specify the data source and a query to run</span>
<span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">f</span>, query <span class="op">=</span> <span class="st">"SELECT AREA, FIPS, geom FROM \"nc.gpkg\" WHERE AREA &lt; 0.1"</span><span class="op">)</span>
<span class="co">#&gt; # Source:   SQL [?? x 3]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;     AREA FIPS                                                               geom</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;                                                &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt;  1 0.061 37005 (((-81.23989 36.36536, -81.24069 36.37942, -81.26284 36.40504, -…</span>
<span class="co">#&gt;  2 0.07  37053 (((-76.00897 36.3196, -76.01735 36.33773, -76.03288 36.33598, -7…</span>
<span class="co">#&gt;  3 0.097 37091 (((-76.74506 36.23392, -76.98069 36.23024, -76.99475 36.23558, -…</span>
<span class="co">#&gt;  4 0.062 37029 (((-76.00897 36.3196, -75.95718 36.19377, -75.98134 36.16973, -7…</span>
<span class="co">#&gt;  5 0.091 37073 (((-76.56251 36.34057, -76.60424 36.31498, -76.64822 36.31532, -…</span>
<span class="co">#&gt;  6 0.072 37181 (((-78.49252 36.17359, -78.51472 36.17522, -78.51709 36.46148, -…</span>
<span class="co">#&gt;  7 0.053 37139 (((-76.29893 36.21423, -76.32423 36.23362, -76.37242 36.25235, -…</span>
<span class="co">#&gt;  8 0.081 37189 (((-81.80622 36.10456, -81.81715 36.10939, -81.82231 36.15786, -…</span>
<span class="co">#&gt;  9 0.063 37143 (((-76.48053 36.07979, -76.53696 36.08792, -76.5756 36.10266, -7…</span>
<span class="co">#&gt; 10 0.044 37041 (((-76.68874 36.29452, -76.64822 36.31532, -76.60424 36.31498, -…</span>
<span class="co">#&gt; # … with more rows</span>

<span class="co">## specify the data source and the table/layer to access</span>
<span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">f</span>, layer <span class="op">=</span> <span class="st">"nc.gpkg"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">AREA</span>, <span class="va">FIPS</span>, <span class="va">geom</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AREA</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co">#&gt; # Source:   lazy query [?? x 3]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;     AREA FIPS                                                               geom</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;                                                &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt;  1 0.061 37005 (((-81.23989 36.36536, -81.24069 36.37942, -81.26284 36.40504, -…</span>
<span class="co">#&gt;  2 0.07  37053 (((-76.00897 36.3196, -76.01735 36.33773, -76.03288 36.33598, -7…</span>
<span class="co">#&gt;  3 0.097 37091 (((-76.74506 36.23392, -76.98069 36.23024, -76.99475 36.23558, -…</span>
<span class="co">#&gt;  4 0.062 37029 (((-76.00897 36.3196, -75.95718 36.19377, -75.98134 36.16973, -7…</span>
<span class="co">#&gt;  5 0.091 37073 (((-76.56251 36.34057, -76.60424 36.31498, -76.64822 36.31532, -…</span>
<span class="co">#&gt;  6 0.072 37181 (((-78.49252 36.17359, -78.51472 36.17522, -78.51709 36.46148, -…</span>
<span class="co">#&gt;  7 0.053 37139 (((-76.29893 36.21423, -76.32423 36.23362, -76.37242 36.25235, -…</span>
<span class="co">#&gt;  8 0.081 37189 (((-81.80622 36.10456, -81.81715 36.10939, -81.82231 36.15786, -…</span>
<span class="co">#&gt;  9 0.063 37143 (((-76.48053 36.07979, -76.53696 36.08792, -76.5756 36.10266, -7…</span>
<span class="co">#&gt; 10 0.044 37041 (((-76.68874 36.29452, -76.64822 36.31532, -76.60424 36.31498, -…</span>
<span class="co">#&gt; # … with more rows</span>


<span class="co">## above was a real database (Geopackage), now with an actual shapefile</span>
<span class="va">shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package <span class="op">=</span> <span class="st">"sf"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">shp</span> <span class="op">%&gt;%</span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">NAME</span> <span class="op">%LIKE%</span> <span class="st">'A%'</span><span class="op">)</span> <span class="op">%&gt;%</span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>abc <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span> <span class="op">%&gt;%</span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">abc</span>, <span class="va">NAME</span>, <span class="va">`_ogr_geometry_`</span><span class="op">)</span> <span class="op">%&gt;%</span>
 <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">NAME</span><span class="op">)</span><span class="op">)</span>  <span class="co">#%&gt;% show_query()</span>
<span class="co">#&gt; # Source:     lazy query [?? x 3]</span>
<span class="co">#&gt; # Database:   SFSQLConnection</span>
<span class="co">#&gt; # Ordered by: desc(NAME)</span>
<span class="co">#&gt;     abc NAME                                                    `_ogr_geometry_`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;                                                      &lt;POLYGON [°]&gt;</span>
<span class="co">#&gt; 1   1.3 Avery    ((-81.94135 35.95498, -81.9614 35.93922, -81.94495 35.91861, -…</span>
<span class="co">#&gt; 2   1.3 Ashe     ((-81.47276 36.23436, -81.54084 36.27251, -81.56198 36.27359, …</span>
<span class="co">#&gt; 3   1.3 Anson    ((-79.91995 34.80792, -80.32528 34.81476, -80.27512 35.19311, …</span>
<span class="co">#&gt; 4   1.3 Allegha… ((-81.23989 36.36536, -81.24069 36.37942, -81.26284 36.40504, …</span>
<span class="co">#&gt; 5   1.3 Alexand… ((-81.10889 35.7719, -81.12728 35.78897, -81.1414 35.82332, -8…</span>
<span class="co">#&gt; 6   1.3 Alamance ((-79.24619 35.86815, -79.23799 35.83725, -79.54099 35.83699, …</span></pre></div>
<p>Online sources can also work if your build of sf supports.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># online sources can work</span>
<span class="va">geojson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/SymbolixAU"</span>,
                      <span class="st">"geojsonsf/master/inst/examples/geo_melbourne.geojson"</span><span class="op">)</span>
<span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">geojson</span><span class="op">)</span>
<span class="co">#&gt; # Source:   table&lt;geo_melbourne&gt; [?? x 8]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;    SA2_NAME polygonId SA3_NAME AREASQKM fillColor strokeColor strokeWeight</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;              &lt;int&gt;</span>
<span class="co">#&gt;  1 Abbotsf…        70 Yarra        1.74 #440154   #440154                1</span>
<span class="co">#&gt;  2 Albert …        59 Port Ph…     4.67 #450457   #450457                1</span>
<span class="co">#&gt;  3 Alphing…        41 Darebin…     2.89 #46075A   #46075A                1</span>
<span class="co">#&gt;  4 Armadale        66 Stonnin…     2.18 #460A5D   #460A5D                1</span>
<span class="co">#&gt;  5 Ascot V…        44 Essendon     3.84 #460C5F   #460C5F                1</span>
<span class="co">#&gt;  6 Brunswi…        36 Brunswi…     5.14 #472D7B   #472D7B                1</span>
<span class="co">#&gt;  7 Brunswi…        37 Brunswi…     2.17 #472D7B   #472D7B                1</span>
<span class="co">#&gt;  8 Brunswi…        38 Brunswi…     3.18 #472E7C   #472E7C                1</span>
<span class="co">#&gt;  9 Carlton         48 Melbour…     1.82 #443A83   #443A83                1</span>
<span class="co">#&gt; 10 Carlton…        71 Yarra        2.30 #443A83   #443A83                1</span>
<span class="co">#&gt; # … with more rows, and 1 more variable: `_ogr_geometry_` &lt;POLYGON [°]&gt;</span></pre></div>
<p>Also works on PostgreSQL with spatial PostGIS (or just normal postgres).</p>
<p>Note that the connection object is a transparent string so take care with your credentials and don’t share in public (currently trying to work out if only the externalptr should be kept in this, or in all cases with GDAL sources).</p>
<p>The <code><a href="reference/SFSQL.html">SFSQL_PG()</a></code> driver is a convenience wrapper around the <code><a href="reference/SFSQL.html">SFSQL()</a></code> driver.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu"><a href="reference/SFSQL.html">SFSQL_PG</a></span><span class="op">(</span><span class="op">)</span>,
          host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"dbedu_host"</span><span class="op">)</span>,
          dbname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"dbedu_dbname"</span><span class="op">)</span>, 
          user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"dbedu_usr"</span><span class="op">)</span>, 
          password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"dbedu_pwd"</span><span class="op">)</span><span class="op">)</span>

<span class="op">(</span><span class="va">sfx</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lazysf.html">lazysf</a></span><span class="op">(</span><span class="va">con</span>, query <span class="op">=</span> <span class="st">"SELECT st_area(st_transform(geom, '+proj=laea +lon_0=-68 +lat_0=-25')) / 1e6 AS sq_km, 
                                        codigo_comuna, geom FROM mapa_comunas WHERE codigo_region = '03'"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # Source:   SQL [?? x 3]</span>
<span class="co">#&gt; # Database: SFSQLConnection</span>
<span class="co">#&gt;    sq_km codigo_comuna                                                      geom</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;                                                &lt;MULTIPOLYGON [°]&gt;</span>
<span class="co">#&gt; 1 18991. 03202         (((-68.36698 -26.79685, -68.36946 -26.79951, -68.38041 -…</span>
<span class="co">#&gt; 2 17789. 03101         (((-68.36698 -26.79685, -68.36379 -26.80107, -68.34811 -…</span>
<span class="co">#&gt; 3  7228. 03301         (((-70.07472 -28.15016, -70.07486 -28.15708, -70.07754 -…</span>
<span class="co">#&gt; 4  3223. 03303         (((-71.57305 -29.02126, -71.56807 -29.02501, -71.56409 -…</span>
<span class="co">#&gt; 5  6158. 03302         (((-69.69013 -28.59016, -69.6956 -28.59591, -69.69542 -2…</span>
<span class="co">#&gt; 6  5773. 03201         (((-70.68641 -26.15053, -70.68303 -26.15132, -70.67828 -…</span>
<span class="co">#&gt; 7  3680. 03102         (((-70.9699 -27.24161, -70.97552 -27.2499, -70.9782 -27.…</span>
<span class="co">#&gt; 8  1601. 03304         (((-71.14553 -27.96365, -71.13859 -27.96908, -71.12689 -…</span>
<span class="co">#&gt; 9 11260. 03103         (((-68.98753 -27.52457, -68.98356 -27.53234, -68.97817 -…</span></pre></div>
<p>You can construct the database connection string yourself and provide it directly to lazysf() if you want. See <a href="https://gdal.org/drivers/vector/pg.html">GDAL Postgres</a> for details on this format, and this capability is available for any of the GDAL formats (see limitations above).</p>
<hr>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the lazysf project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mdsumner/lazysf/">https://​github.com/​mdsumner/​lazysf/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mdsumner/lazysf/issues">https://​github.com/​mdsumner/​lazysf/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Michael Sumner <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
